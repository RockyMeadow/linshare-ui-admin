<div class="box box-primary">
  <div class="box-header">
    <h3 class="box-title">
      {{mail.identifier}}
    </h3>
    <div class="pull-right box-tools">
      <div class="btn-group">
        <button class="btn btn-primary pull-right" type="button"
                x-ng-click="cancel()">
          <span>
            <i class="fa fa-list"></i> 
            {{'P_Users-Mails_List' | i18n}}
          </span>
        </button>
      </div>
    </div>
  </div>
  <form class="form" name="mailForm" novalidate
      x-ls-form-submit="submit()"
      x-ls-form-attempt>
    <fieldset>
      <div class="box-body">
        <!-- Description -->
        <div class="form-group">
          <label for="description">
            {{'P_Users-Mails_FormDescription' | i18n}}
          </label>
          <input type="text" id="description" name="description" class="form-control"
                 x-ng-model="mail.description">
        </div>
        <!-- Visibility -->
        <div class="form-group">
          <label for="isPublic">
            {{'P_Users-Mails_FormIsPublic' | i18n}}
          </label>
          <div class="input-group col-sm-1">
            <span class="input-group-addon">
              <input id="isPublic" name="isPublic" type="checkbox"
                     x-ng-model="mail.public">
            </span>
            <input type="text" class="form-control" style="background-color: transparent" disabled
                   value="{{mail.public ? 'P_Users-Mails_ListPublic' : 'P_Users-Mails_ListPrivate' | i18n}}">
          </div>
        </div>
        <!-- Owner -->
        <div class="form-group">
          <label for="owner">
            {{'P_Users-Mails_FormOwner' | i18n}}
          </label>
          <div class="controls">
            <span name="owner" class="form-control-static">
              {{mail.owner.firstName}}&nbsp;-&nbsp;{{mail.owner.lastName}}
            </span>
          </div>
        </div>
      </div>
      <div class="box-footer">
        <!-- Validation -->
        <div class="control-group">
          <div class="controls">
            <button id="delete" name="delete" type="button" class="btn btn-danger"
                    x-ng-click="remove()">
              {{'P_Users-Mails_FormDelete' | i18n}}
            </button>
            <button type="button" id="reset" name="reset" class="btn btn-warning"
                    x-ng-click="reset()">
              {{'P_Users-Mails_FormReset' | i18n}}
            </button>
            <button type="submit" id="submit" name="submit" class="btn btn-success">
              {{'P_Users-Mails_FormSubmit' | i18n}}
            </button>
          </div>
        </div>
      </div>
    </fieldset>
  </form>
</div>

<!-- USER LIST -->

<script type="text/ng-template" id="user_representation">
  <a>
    <span bind-html-unsafe="match.model.firstName | typeaheadHighlight:query"></span>&nbsp;
    <span bind-html-unsafe="match.model.lastName | typeaheadHighlight:query"></span>&nbsp;&lt;
    <span bind-html-unsafe="match.model.mail | typeaheadHighlight:query"></span>&gt;
  </a>
</script>

<div class="box box-primary">
  <div class="box-header">
    <h3 class="box-title">
      {{'P_Users-Mails_MemberTitle' | i18n}}
    </h3>
  </div>
  <div class="box-body">
    <form class="form-inline form-group"
        x-ls-form-submit="addContact(contactToAdd)"
        x-ls-form-attempt>
      <div class="form-group col-sm-4">
        <label class="sr-only" for="mail">
          {{'P_Users-Mails_ContactMail' | i18n}}
        </label>
        <input type="text" class="form-control" id="mail" required
               placeholder="{{'P_Users-Mails_ContactMail' | i18n}}"
               x-ng-model="autocompleteValue"
               x-typeahead-min-length="3"
               x-typeahead-wait-ms="30"
               x-typeahead-loading="searching"
               x-typeahead-on-select="fieldForm(autocompleteValue)"
               x-typeahead="u for u in autocompleteUsers($viewValue) | filter:$viewValue"
               x-typeahead-template-url="user_representation"/>
      </div>
      <div class="form-group col-sm-3">
        <label class="sr-only" for="firstName">
          {{'P_Users-Mails_ContactFirstName' | i18n}}
        </label>
        <input type="text" class="form-control" id="firstName"
               placeholder="{{'P_Users-Mails_ContactFirstName' | i18n}}"
               x-ng-model="contactToAdd.firstName"/>
      </div>
      <div class="form-group col-sm-3">
        <label class="sr-only" for="lastName">
          {{'P_Users-Mails_ContactLastName' | i18n}}
        </label>
        <input type="text" class="form-control" id="lastName"
               placeholder="{{'P_Users-Mails_ContactLastName' | i18n}}"
               x-ng-model="contactToAdd.lastName"/>
      </div>
      <button type="submit" class="btn btn-success">
        <i class="fa fa-plus"></i>&nbsp;
        {{'P_Users-Mails_ContactAdd' | i18n}}
      </button>
    </form>
    <div class="form-group">
      <div class="table-responsive">
        <table class="table"
               x-ng-table="tableParams">
          <tr x-ng-repeat="contact in $data">
            <td class="col-sm-4"
                data-title="'P_Users-Mails_ContactMail' | i18n"
                sortable="'mail'">
              <span>
                {{contact.mail}}
              </span>
            </td>
            <td class="col-sm-3"
                data-title="'P_Users-Mails_ContactFirstName' | i18n"
                sortable="'firstName'">
              <span>
                {{contact.firstName}}
              </span>
            </td>
            <td class="col-sm-3"
                data-title="'P_Users-Mails_ContactLastName' | i18n"
                sortable="'lastName'">
              <span>
                {{contact.lastName}}
              </span>
            </td>
            <td class="col-sm-2"
                data-title="'P_Users-Mails_ContactActions' | i18n">
              <button class="btn btn-danger"
                      x-ng-show="confirm === undefined"
                      x-ng-click="confirm = $index">
                {{'P_Users-Mails_ContactDelete' | i18n}}
              </button>
              <button class="btn"
                      x-ng-show="confirm === $index"
                      x-ng-click="confirm = undefined">
                {{'G_App_ConfirmNo' | i18n}}
              </button>
              <button class="btn btn-danger"
                      x-ng-show="confirm === $index"
                      x-ng-click="deleteContact(contact)">
                {{'G_App_ConfirmYes' | i18n}}
              </button>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>
